#!/bin/bash
###############
# some config
xrmode=$1
echo "$xrmode"
xrmain="LVDS-1"
xrmain_res="1366x768"
xrmain_scale=""
xr2nd="VGA-1"
xr2nd_digi="DP1"
xr2nd_scale=""
#xr2nd_digi="HDMI1"

_ck=$(xrandr | grep "eDP-1 connected")
if [ $? = 0 ]; then
  xrmain="eDP-1"
  xrmain_res="2560x1440"
  xrmain_scale="--scale 1x1"
  xr2nd="HDMI-1"
  xr2nd_scale="--scale 1.35x1.35"
  xr2nd_fb="--panning 2560x1440+2560+0"
fi

function bg_set() {
    if [ -f "${HOME}/.fehbg" ]; then
        #`sed "s,',,g" "${HOME}/.fehbg"`
        echo CHECK ~/.fehbg !
    fi
}

###############
# notebook
xrandr --output $xrmain --mode $xrmain_res $xrmain_scale

# on "Can't open display" use -d :0 for xrandr


###############
# single-display
if [[ "x${xrmode}" = "x--single" ]]; then
    echo "Switching to single-display mode..."
    RET=$(xrandr --output $xr2nd --off)
    bg_set
    exit $RET;
fi
# wtf?
#xrandr --output VGA1 --mode 2048x1152 --right-of LVDS1

###############
# small one
xr2nd_res='1680x1050'
if [[ "x${xrmode}" = "x--small" ]]; then
    echo "Second screen: $xr2nd_res (right)"
    xrandr --output $xr2nd --mode $xr2nd_res --right-of $xrmain --rotate normal
    bg_set
    exit $?;
fi
if [[ "x${xrmode}" = "x--small2" ]]; then
    echo "Second screen: $xr2nd_res (above)"
    xrandr --output $xr2nd --mode $xr2nd_res --above $xrmain --rotate normal
    bg_set
    exit $?;
fi

###############
# beamer
xr2nd_res='1024x768'
if [[ "x${xrmode}" = "x--beamer" ]]; then
    echo "Second screen: $xr2nd_res (mirror)"
xr2nd_res='1366x768'
xr2nd="HDMI1"
    xrandr --output $xr2nd --mode $xr2nd_res --same-as $xrmain --rotate normal
    bg_set
    exit $?;
fi

xr2nd_res='1280x1024'
if [[ "x${xrmode}" = "x--left" ]]; then
    echo "Second screen: $xr2nd_res (left)"
    xrandr --output $xr2nd --mode $xr2nd_res --left-of $xrmain --rotate normal
    bg_set
    exit $?;
fi

xr2nd_res='1280x1024'
if [[ "x${xrmode}" = "x--above" ]]; then
    echo "Second screen: $xr2nd_res (left)"
    xrandr --output $xr2nd --mode $xr2nd_res --above $xrmain --rotate normal
    bg_set
    exit $?;
fi

###############
# big samsung
xr2nd_res='1920x1080'
xr3rd_res='1024x768'
if [[ "x${xrmode}" = "x--double" ]]; then
    echo "Second screen: $xr2nd_res (right)"
    xrandr --output $xr2nd --mode $xr2nd_res --right-of $xrmain --rotate normal $xr2nd_scale $xr2nd_fb --auto
    bg_set
    exit $?;
fi
if [[ "x${xrmode}" = "x--double2" ]]; then
    xxr2nd_res='1920x1200'
    echo "Second screen: $xxr2nd_res (right)"
    xrandr --output $xr2nd --mode $xxr2nd_res --right-of $xrmain --rotate normal
    bg_set
    exit $?;
fi

if [[ "x${xrmode}" = "x--ddouble" ]]; then
    echo "Second screen: $xr2nd_res (right)"
    echo xrandr --output $xr2nd_digi --mode $xr2nd_res --right-of $xrmain --rotate normal
    xrandr --output $xr2nd_digi --mode $xr2nd_res --right-of $xrmain --rotate normal
    bg_set
    exit $?;
fi

if [[ "x${xrmode}" = "x--triple" ]]; then
    echo "Second screen: $xr2nd_res (right)"
    echo xrandr --output $xr2nd_digi --mode $xr2nd_res --right-of $xrmain --rotate normal
    xrandr --output $xr2nd_digi --mode $xr2nd_res --right-of $xrmain --rotate normal
    xrandr --output $xr2nd --mode $xr3rd_res --right-of $xr2nd_digi --rotate normal
    bg_set
    exit $?;
fi
# big dell2
if [[ "x${xrmode}" = "x--dell2" ]]; then
    xrandr --output $xrmain --mode "1366x768"
    echo "Second screen: 1920x1080 (right)"
    xrandr --output $xr2nd --mode 1920x1080 --right-of $xrmain  --rotate normal
    exit $?;
fi

# digital borked
#xrandr --output DP1 --mode 1920x1080 --right-of LVDS1 --rotate normal

ac tr
